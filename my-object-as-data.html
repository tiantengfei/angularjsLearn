<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <title>Array as Data</title>
    <link rel="stylesheet" type="text/css" href="css/styles.css"/>
    <script type="text/javascript" src="lib/d3.js"></script>
    <script type="text/javascript">
        var data = [
            {width: 10, color: 23},{width: 15, color: 33},
            {width: 30, color: 40},{width: 50, color: 60},
            {width: 80, color: 22},{width: 65, color: 10},
            {width: 55, color: 5},{width: 30, color: 30},
            {width: 20, color: 60},{width: 10, color: 90},
            {width: 8, color: 10}
        ];

        var ds = [
            {width: 20, color: 23},{width: 35, color: 33},
            {width: 30, color: 40},{width: 50, color: 60},
            {width: 80, color: 22},{width: 65, color: 10},
            {width: 55, color: 5},{width: 30, color: 30},
            {width: 20, color: 60},{width: 10, color: 90},
            {width: 8, color: 10},{width:50,color:100}
        ];

        var di = data;
        var colorScale = d3.scale.linear()
                .domain([0, 100]).range(["#add8e6", "blue"]);
        function renderData() {
         //alert("new data:" + data[10].width);
            //enter
          //  data.push({width:randomValue(), color:randomValue() });
            d3.select("body").selectAll("div.h-bar").data(di).
                    enter().append("div").attr("class", "h-bar").
                    append("span").text(function(d){

                        alert(" I am running");
                        return "enter: " + d.width;
                    });

          alert("middle");
            //update
          d3.select("body").selectAll("div.h-bar").data(di).style("width", function (d) {

                return d.width * 3 + "px";
            }).style("background",function(d){

             // alert(d.width);
              return colorScale(d.color);

          }).select("span").text(function(d) {


                      return d.width;
                  }
          );

            //exit
          // alert("enter");
         d3.select("body").selectAll("div.h-bar").data(di).exit().remove(function(d){
             alert("exit" + d.with);
         });
          //  alert("exit");
        }

        function randomValue(){

            return Math.round(Math.random() * 100);
        }
        setInterval(function(){
           // data.shift();
           // data.push({width:randomValue(), color:randomValue() });
            if (di == data){
                di = ds;
            }else {
                di = data;
            }
            renderData();
        },1500)

    </script>
</head>

<body>

</body>
</html>